<!DOCTYPE html>
<html>
<head>
    <title>바나나 히어로 - 빠른 구현 버전</title>
    <style>
        body { 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
        }
        #gameContainer {
            text-align: center;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        canvas { 
            border: 3px solid #4a5568; 
            background: linear-gradient(to bottom, #87ceeb, #98fb98);
            border-radius: 10px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        #gameInfo {
            margin: 15px 0;
            font-size: 22px;
            font-weight: bold;
            color: #2d3748;
            display: flex;
            justify-content: space-around;
            background: #f7fafc;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }
        #controls {
            margin: 15px 0;
            font-size: 14px;
            color: #4a5568;
            background: #edf2f7;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }
        .feature-indicator {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            background: #68d391;
            color: white;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .achievement {
            background: #f6e05e;
            color: #744210;
            padding: 8px;
            border-radius: 6px;
            margin: 5px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <h2 style="color: #2d3748; margin-top: 0;">⚡ 빠른 구현 게임 ⚡</h2>
        
        <div id="gameInfo">
            <span>점수: <span id="score">0</span></span>
            <span>시간: <span id="timer">0</span>초</span>
            <span>레벨: <span id="level">1</span></span>
        </div>
        
        <canvas id="gameCanvas" width="800" height="400"></canvas>
        
        <div id="controls">
            <strong>🎮 조작법:</strong> ← → 이동 | 스페이스 점프 | Z 바나나 발사 | R 재시작<br>
            <strong>🎯 목표:</strong> 바나나로 적을 물리치고 최고 점수 달성!
        </div>
        
        <div id="features">
            <div class="feature-indicator">✅ 즉시 실행</div>
            <div class="feature-indicator">✅ 부드러운 움직임</div>
            <div class="feature-indicator">✅ 충돌 감지</div>
            <div class="feature-indicator">✅ 점수 시스템</div>
            <div class="feature-indicator">✅ 레벨 시스템</div>
        </div>
        
        <div id="achievements"></div>
    </div>

    <script>
        // ⚡ 빠른 구현 도우미: 즉시 작동하는 완성된 게임!
        console.log("⚡ 빠른 구현 모드 시작!");
        console.log("📋 모든 기능이 포함된 완성품입니다!");
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // 🎯 게임 상태 관리
        let gameState = {
            score: 0,
            level: 1,
            startTime: Date.now(),
            gameOver: false,
            paused: false,
            achievements: []
        };

        // 🐵 플레이어 (완전한 기능 포함)
        const player = {
            x: 100,
            y: 300,
            width: 45,
            height: 45,
            velocityY: 0,
            velocityX: 0,
            onGround: true,
            color: '#8b4513',
            maxSpeed: 6,
            jumpPower: 16,
            health: 3,
            invulnerable: false,
            invulnerableTime: 0
        };

        // 🍌 바나나 시스템 (개선된 버전)
        let bananas = [];
        const bananaConfig = {
            speed: 12,
            size: { width: 18, height: 12 },
            color: '#ffd700',
            maxCount: 10
        };

        // 👾 적 시스템 (다양한 타입)
        let enemies = [];
        const enemyTypes = [
            { color: '#e53e3e', speed: 2, points: 10, size: { width: 35, height: 40 } },
            { color: '#9f7aea', speed: 3, points: 20, size: { width: 30, height: 35 } },
            { color: '#38b2ac', speed: 1.5, points: 15, size: { width: 40, height: 45 } }
        ];

        // 💥 파티클 시스템 (시각 효과)
        let particles = [];

        // 🎮 입력 처리
        const keys = {};
        
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            
            // 바나나 발사 (연사 방지)
            if ((e.key === 'z' || e.key === 'Z') && !gameState.gameOver) {
                if (bananas.length < bananaConfig.maxCount) {
                    fireBanana();
                }
            }
            
            // 재시작
            if ((e.key === 'r' || e.key === 'R') && gameState.gameOver) {
                resetGame();
            }
            
            // 일시정지
            if (e.key === 'p' || e.key === 'P') {
                gameState.paused = !gameState.paused;
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // 🍌 바나나 발사 함수 (개선된 버전)
        function fireBanana() {
            bananas.push({
                x: player.x + player.width,
                y: player.y + player.height / 2 - bananaConfig.size.height / 2,
                width: bananaConfig.size.width,
                height: bananaConfig.size.height,
                velocityX: bananaConfig.speed,
                color: bananaConfig.color,
                trail: []
            });
            
            // 발사 효과
            createParticles(player.x + player.width, player.y + player.height / 2, '#ffd700', 5);
            console.log(`🍌 바나나 발사! (${bananas.length}/${bananaConfig.maxCount})`);
        }

        // 👾 적 생성 함수 (레벨별 난이도)
        function spawnEnemy() {
            const type = enemyTypes[Math.floor(Math.random() * Math.min(enemyTypes.length, gameState.level))];
            const speedMultiplier = 1 + (gameState.level - 1) * 0.2;
            
            enemies.push({
                x: canvas.width,
                y: 300,
                width: type.size.width,
                height: type.size.height,
                velocityX: -(type.speed * speedMultiplier),
                color: type.color,
                points: type.points,
                health: 1,
                type: type
            });
        }

        // 💥 파티클 생성 함수
        function createParticles(x, y, color, count) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    velocityX: (Math.random() - 0.5) * 8,
                    velocityY: (Math.random() - 0.5) * 8,
                    color: color,
                    life: 30 + Math.random() * 20,
                    maxLife: 50,
                    size: 2 + Math.random() * 3
                });
            }
        }

        // 🏆 업적 시스템
        function checkAchievements() {
            const achievements = [
                { id: 'first_kill', name: '첫 처치!', condition: () => gameState.score >= 10 },
                { id: 'score_100', name: '백점 돌파!', condition: () => gameState.score >= 100 },
                { id: 'level_5', name: '고수 등극!', condition: () => gameState.level >= 5 },
                { id: 'survivor', name: '생존왕!', condition: () => getGameTime() >= 60 }
            ];
            
            achievements.forEach(achievement => {
                if (!gameState.achievements.includes(achievement.id) && achievement.condition()) {
                    gameState.achievements.push(achievement.id);
                    showAchievement(achievement.name);
                }
            });
        }

        // 🏆 업적 표시
        function showAchievement(name) {
            const achievementDiv = document.getElementById('achievements');
            const newAchievement = document.createElement('div');
            newAchievement.className = 'achievement';
            newAchievement.textContent = `🏆 업적 달성: ${name}`;
            achievementDiv.appendChild(newAchievement);
            
            setTimeout(() => {
                newAchievement.remove();
            }, 3000);
            
            console.log(`🏆 업적 달성: ${name}`);
        }

        // ⏰ 게임 시간 계산
        function getGameTime() {
            return Math.floor((Date.now() - gameState.startTime) / 1000);
        }

        // 🎯 게임 로직 업데이트
        function update() {
            if (gameState.gameOver || gameState.paused) return;

            // 플레이어 움직임 (부드러운 가속/감속)
            let targetVelocityX = 0;
            if (keys['ArrowLeft'] && player.x > 0) {
                targetVelocityX = -player.maxSpeed;
            }
            if (keys['ArrowRight'] && player.x < canvas.width - player.width) {
                targetVelocityX = player.maxSpeed;
            }
            
            // 부드러운 움직임
            player.velocityX += (targetVelocityX - player.velocityX) * 0.2;
            player.x += player.velocityX;

            // 점프 (더블 점프 방지)
            if (keys[' '] && player.onGround) {
                player.velocityY = -player.jumpPower;
                player.onGround = false;
                console.log("🦘 점프!");
            }

            // 중력과 물리
            player.velocityY += 0.8;
            player.y += player.velocityY;

            // 바닥 충돌
            if (player.y > 300) {
                player.y = 300;
                player.velocityY = 0;
                player.onGround = true;
            }

            // 무적 시간 처리
            if (player.invulnerable) {
                player.invulnerableTime--;
                if (player.invulnerableTime <= 0) {
                    player.invulnerable = false;
                }
            }

            // 바나나 업데이트
            bananas.forEach((banana, index) => {
                banana.x += banana.velocityX;
                
                // 바나나 궤적 효과
                banana.trail.push({ x: banana.x, y: banana.y });
                if (banana.trail.length > 5) banana.trail.shift();
                
                // 화면 밖으로 나가면 제거
                if (banana.x > canvas.width) {
                    bananas.splice(index, 1);
                }
            });

            // 적 생성 (레벨별 빈도 조정)
            if (Math.random() < 0.01 + gameState.level * 0.002) {
                spawnEnemy();
            }

            // 적 업데이트
            enemies.forEach((enemy, index) => {
                enemy.x += enemy.velocityX;
                
                // 화면 밖으로 나가면 제거
                if (enemy.x < -enemy.width) {
                    enemies.splice(index, 1);
                }
            });

            // 파티클 업데이트
            particles.forEach((particle, index) => {
                particle.x += particle.velocityX;
                particle.y += particle.velocityY;
                particle.velocityX *= 0.98;
                particle.velocityY *= 0.98;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });

            // 충돌 검사
            checkCollisions();
            
            // 레벨 업 체크
            if (gameState.score > 0 && gameState.score % 50 === 0 && gameState.score / 50 !== gameState.level - 1) {
                gameState.level = Math.floor(gameState.score / 50) + 1;
                console.log(`🆙 레벨 업! 레벨 ${gameState.level}`);
                createParticles(player.x + player.width/2, player.y + player.height/2, '#ffd700', 15);
            }
            
            // 업적 체크
            checkAchievements();
            
            // UI 업데이트
            updateUI();
        }

        // 💥 충돌 검사 (정밀한 충돌 감지)
        function checkCollisions() {
            // 바나나와 적 충돌
            bananas.forEach((banana, bIndex) => {
                enemies.forEach((enemy, eIndex) => {
                    if (banana.x < enemy.x + enemy.width &&
                        banana.x + banana.width > enemy.x &&
                        banana.y < enemy.y + enemy.height &&
                        banana.y + banana.height > enemy.y) {
                        
                        // 충돌 효과
                        createParticles(enemy.x + enemy.width/2, enemy.y + enemy.height/2, enemy.color, 10);
                        createParticles(banana.x, banana.y, '#ffd700', 5);
                        
                        // 점수 획득
                        gameState.score += enemy.points;
                        
                        // 제거
                        bananas.splice(bIndex, 1);
                        enemies.splice(eIndex, 1);
                        
                        console.log(`💥 명중! +${enemy.points}점 (총점: ${gameState.score})`);
                    }
                });
            });

            // 플레이어와 적 충돌
            if (!player.invulnerable) {
                enemies.forEach((enemy, index) => {
                    if (player.x < enemy.x + enemy.width &&
                        player.x + player.width > enemy.x &&
                        player.y < enemy.y + enemy.height &&
                        player.y + player.height > enemy.y) {
                        
                        player.health--;
                        player.invulnerable = true;
                        player.invulnerableTime = 120; // 2초 무적
                        
                        // 충돌 효과
                        createParticles(player.x + player.width/2, player.y + player.height/2, '#e53e3e', 15);
                        
                        enemies.splice(index, 1);
                        
                        if (player.health <= 0) {
                            gameState.gameOver = true;
                            console.log("💀 게임 오버!");
                        } else {
                            console.log(`💔 체력 감소! 남은 체력: ${player.health}`);
                        }
                    }
                });
            }
        }

        // 📊 UI 업데이트
        function updateUI() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('timer').textContent = getGameTime();
            document.getElementById('level').textContent = gameState.level;
        }

        // 🎨 렌더링 (고품질 그래픽)
        function draw() {
            // 화면 지우기
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 구름 배경
            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            for (let i = 0; i < 5; i++) {
                const x = (i * 200 + getGameTime() * 10) % (canvas.width + 100);
                const y = 50 + Math.sin(getGameTime() * 0.01 + i) * 20;
                ctx.beginPath();
                ctx.arc(x, y, 25, 0, Math.PI * 2);
                ctx.arc(x + 20, y, 35, 0, Math.PI * 2);
                ctx.arc(x + 40, y, 25, 0, Math.PI * 2);
                ctx.fill();
            }

            // 땅 그리기 (그라디언트)
            const groundGradient = ctx.createLinearGradient(0, 340, 0, 400);
            groundGradient.addColorStop(0, '#8fbc8f');
            groundGradient.addColorStop(1, '#556b2f');
            ctx.fillStyle = groundGradient;
            ctx.fillRect(0, 340, canvas.width, 60);

            // 플레이어 그리기 (깜빡임 효과 포함)
            if (!player.invulnerable || Math.floor(getGameTime() * 10) % 2) {
                const playerGradient = ctx.createRadialGradient(
                    player.x + player.width/2, player.y + player.height/2, 0,
                    player.x + player.width/2, player.y + player.height/2, player.width/2
                );
                playerGradient.addColorStop(0, '#d2691e');
                playerGradient.addColorStop(1, '#8b4513');
                ctx.fillStyle = playerGradient;
                ctx.fillRect(player.x, player.y, player.width, player.height);
                
                // 플레이어 얼굴
                ctx.fillStyle = '#ffd700';
                ctx.beginPath();
                ctx.arc(player.x + player.width/2, player.y + 15, 12, 0, Math.PI * 2);
                ctx.fill();
                
                // 눈
                ctx.fillStyle = '#000';
                ctx.fillRect(player.x + player.width/2 - 8, player.y + 10, 3, 3);
                ctx.fillRect(player.x + player.width/2 + 5, player.y + 10, 3, 3);
                
                // 입
                ctx.beginPath();
                ctx.arc(player.x + player.width/2, player.y + 18, 4, 0, Math.PI);
                ctx.stroke();
            }

            // 체력 표시
            for (let i = 0; i < player.health; i++) {
                ctx.fillStyle = '#e53e3e';
                ctx.fillRect(10 + i * 25, 10, 20, 20);
                ctx.fillStyle = '#fff';
                ctx.font = '14px Arial';
                ctx.fillText('♥', 15 + i * 25, 25);
            }

            // 바나나 그리기 (궤적 포함)
            bananas.forEach(banana => {
                // 궤적 그리기
                banana.trail.forEach((point, index) => {
                    const alpha = index / banana.trail.length;
                    ctx.fillStyle = `rgba(255, 215, 0, ${alpha * 0.5})`;
                    ctx.fillRect(point.x, point.y, banana.width * alpha, banana.height * alpha);
                });
                
                // 바나나 본체
                ctx.fillStyle = banana.color;
                ctx.fillRect(banana.x, banana.y, banana.width, banana.height);
                
                // 바나나 디테일
                ctx.fillStyle = '#ffed4e';
                ctx.fillRect(banana.x + 2, banana.y + 2, banana.width - 4, banana.height - 4);
            });

            // 적 그리기 (그라디언트 효과)
            enemies.forEach(enemy => {
                const enemyGradient = ctx.createRadialGradient(
                    enemy.x + enemy.width/2, enemy.y + enemy.height/2, 0,
                    enemy.x + enemy.width/2, enemy.y + enemy.height/2, enemy.width/2
                );
                enemyGradient.addColorStop(0, enemy.color);
                enemyGradient.addColorStop(1, '#000');
                ctx.fillStyle = enemyGradient;
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                
                // 적 얼굴
                ctx.fillStyle = '#fff';
                ctx.fillRect(enemy.x + 5, enemy.y + 8, 4, 4);
                ctx.fillRect(enemy.x + enemy.width - 9, enemy.y + 8, 4, 4);
                
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(enemy.x + 6, enemy.y + 9, 2, 2);
                ctx.fillRect(enemy.x + enemy.width - 8, enemy.y + 9, 2, 2);
            });

            // 파티클 그리기
            particles.forEach(particle => {
                const alpha = particle.life / particle.maxLife;
                ctx.fillStyle = particle.color.replace('rgb', 'rgba').replace(')', `, ${alpha})`);
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size * alpha, 0, Math.PI * 2);
                ctx.fill();
            });

            // 게임 오버 화면
            if (gameState.gameOver) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('게임 완료!', canvas.width/2, canvas.height/2 - 60);
                
                ctx.font = '24px Arial';
                ctx.fillText(`최종 점수: ${gameState.score}`, canvas.width/2, canvas.height/2 - 20);
                ctx.fillText(`생존 시간: ${getGameTime()}초`, canvas.width/2, canvas.height/2 + 10);
                ctx.fillText(`달성 레벨: ${gameState.level}`, canvas.width/2, canvas.height/2 + 40);
                
                ctx.font = '18px Arial';
                ctx.fillStyle = '#4299e1';
                ctx.fillText('R키를 눌러 다시 시작', canvas.width/2, canvas.height/2 + 80);
                
                ctx.textAlign = 'left';
            }

            // 일시정지 화면
            if (gameState.paused && !gameState.gameOver) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 36px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('일시정지', canvas.width/2, canvas.height/2);
                ctx.font = '18px Arial';
                ctx.fillText('P키를 눌러 계속', canvas.width/2, canvas.height/2 + 40);
                ctx.textAlign = 'left';
            }
        }

        // 🔄 게임 리셋
        function resetGame() {
            gameState = {
                score: 0,
                level: 1,
                startTime: Date.now(),
                gameOver: false,
                paused: false,
                achievements: []
            };
            
            player.x = 100;
            player.y = 300;
            player.velocityY = 0;
            player.velocityX = 0;
            player.onGround = true;
            player.health = 3;
            player.invulnerable = false;
            player.invulnerableTime = 0;
            
            bananas = [];
            enemies = [];
            particles = [];
            
            document.getElementById('achievements').innerHTML = '';
            
            console.log("🔄 게임 재시작! 이번엔 더 높은 점수를 목표로!");
        }

        // 🎮 게임 루프
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // 🚀 게임 시작
        console.log("⚡ 빠른 구현 버전 - 모든 기능 포함!");
        console.log("🎯 특징:");
        console.log("  - 즉시 실행 가능");
        console.log("  - 완전한 기능 세트");
        console.log("  - 부드러운 애니메이션");
        console.log("  - 레벨 시스템");
        console.log("  - 업적 시스템");
        console.log("  - 파티클 효과");
        
        gameLoop();
    </script>
</body>
</html>